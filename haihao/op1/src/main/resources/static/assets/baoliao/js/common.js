var nativeShare=function(){var e='<div class="share-box js-share-box">      <ul>        <li>          <a href="javascript:void(0)" class="js-share-qq js-share-cancel">            <i class="imwap-qq_o"></i><span>QQ空间</span>          </a>        </li>        <li>          <a href="javascript:void(0)" class="js-share-weibo js-share-cancel">            <i class="imwap-weibo_o"></i><span>微博</span>          </a>        </li>      </ul>      <a href="javascript:void(0)" class="btn-share-cancel js-share-cancel">取消</a>    </div>    <div class="mask-view js-share-mask"></div>',a='<div class="share-box share-box-wx js-share-box">      <ul>        <li>          <a data-app="QZone"  href="javascript:void(0)" class="js-share-qq js-share-cancel">            <i class="imwap-qq_o"></i><span>QQ空间</span>          </a>        </li>        <li class="share-wechat">          <a data-app="weixin" href="javascript:void(0)" class="js-share-wechat js-share-cancel">            <i class="imwap-wechat_o"></i><span>微信</span>          </a>        </li>        <li class="share-friends">          <a data-app="weixinFriend" href="javascript:void(0)" class="js-share-friends js-share-cancel">            <i class="imwap-friends"></i><span>朋友圈</span>          </a>        </li>        <li>          <a href="javascript:void(0)"  data-app="sinaWeibo" class="js-share-weibo js-share-cancel">            <i class="imwap-weibo_o"></i><span>微博</span>          </a>        </li>      </ul>      <a href="javascript:void(0)" class="btn-share-cancel js-share-cancel">取消</a>    </div>    <div class="mask-view js-share-mask"></div>',s={lower:"http://3gimg.qq.com/html5/js/qb.js",higher:"http://jsapi.qq.com/get?api=app.share"},i={qq:{forbid:0,lower:1,higher:2},uc:{forbid:0,allow:1}},r=navigator.appVersion,t=r.split("MQQBrowser/").length>1?i.qq.higher:i.qq.forbid,o=r.split("UCBrowser/").length>1?i.uc.allow:i.uc.forbid,n={uc:"",qq:""},c=!1;this.ucAppList={sinaWeibo:["kSinaWeibo","SinaWeibo",11,"新浪微博"],weixin:["kWeixin","WechatFriends",1,"微信好友"],weixinFriend:["kWeixinFriend","WechatTimeline","8","微信朋友圈"],QQ:["kQQ","QQ","4","QQ好友"],QZone:["kQZone","QZone","3","QQ空间"]},this.share=function(e){var a=shareData.title,s=shareData.url,r=shareData.desc,n=shareData.imgUrl,h=shareData.url;if(o)e=""==e?"":"iPhone"==platform_os?this.ucAppList[e][0]:this.ucAppList[e][1],"QZone"==e&&(B="mqqapi://share/to_qzone?src_type=web&version=1&file_type=news&req_type=1&image_url="+n+"&title="+a+"&description="+r+"&url="+s+"&app_name="+h,k=document.createElement("div"),k.style.visibility="hidden",k.innerHTML='<iframe src="'+B+'" scrolling="no" width="1" height="1"></iframe>',document.body.appendChild(k),setTimeout(function(){k&&k.parentNode&&k.parentNode.removeChild(k)},5e3)),"undefined"!=typeof ucweb?ucweb.startRequest("shell.page_share",[a,a,s,e,"","@"+h,""]):"undefined"!=typeof ucbrowser&&ucbrowser.web_share(a,a,s,e,"","@"+h,"");else if(t&&!c){e=""==e?"":this.ucAppList[e][2];var l={url:s,title:a,description:r,img_url:n,to_app:e,cus_txt:"请输入想要分享的内容"};l=""==e?"":l,"undefined"!=typeof browser?"undefined"!=typeof browser.app&&t==i.qq.higher&&browser.app.share(l):"undefined"!=typeof window.qb&&t==i.qq.lower&&window.qb.share(l)}},this.isloadqqApi=function(){if(t){var e=n.qq<5.4?s.lower:s.higher,a=document.createElement("script"),i=document.getElementsByTagName("body")[0];a.setAttribute("src",e),i.appendChild(a)}},this.getPlantform=function(){return ua=navigator.userAgent,ua.indexOf("iPhone")>-1||ua.indexOf("iPod")>-1?"iPhone":"Android"},this.is_weixin=function(){var e=r.toLowerCase();return"micromessenger"==e.match(/MicroMessenger/i)?!0:!1},this.getVersion=function(e){var a=e.split("."),s=parseFloat(a[0]+"."+a[1]);return s},this.init=function(){platform_os=this.getPlantform(),n.qq=t?this.getVersion(r.split("MQQBrowser/")[1]):0,n.uc=o?this.getVersion(r.split("UCBrowser/")[1]):0,c=this.is_weixin(),t&&n.qq<5.4&&"iPhone"==platform_os||t&&n.qq<5.3&&"Android"==platform_os?t=i.qq.forbid:t&&n.qq<5.4&&"Android"==platform_os?t=i.qq.lower:o&&(n.uc<10.2&&"iPhone"==platform_os||n.uc<9.7&&"Android"==platform_os)&&(o=i.uc.forbid);var s=this;t||o?(this.isloadqqApi(),$(document.body).append(a),$(".js-share-box a").on("click",function(){s.share($(this).data("app"))})):$(document.body).append(e).on("click",".js-share-qq",function(){var e="http://sns.qzone.qq.com/cgi-bin/qzshare/cgi_qzshare_onekey?url="+shareData.url+"&title="+shareData.title+"&desc="+shareData.desc+"&summary=&site=&pics="+shareData.imgUrl;window.open(e)}).on("click",".js-share-weibo",function(){var e="http://service.weibo.com/share/share.php?url="+shareData.url+"&title="+shareData.title+"&appkey=2254855082&pic="+shareData.imgUrl+"&searchPic=true";window.open(e)})},this.init()};$(function(){userInfo&&$(".js-header-avator").size()>0&&$.ajax({url:"/api/user/userinfo.html",dataType:"json",type:"get",success:function(e){if(200==e.code){var a='<img src="'+e.data[0].pic+'" />';$(".js-header-avator").html(a)}}}),$("header").hasClass("opacity")&&$(document).on("scroll",function(){$(document.body).scrollTop()>0?$("header").removeClass("opacity"):$("header").addClass("opacity")}),$(document).on("click",".js-share",function(){$(".js-share-box").length?($(".js-share-box").show(),$(".js-share-mask").show()):nativeShare()}).on("click",".js-share-cancel",function(){$(".js-share-box").hide(),$(".js-share-mask").hide()}).on("click",".js-share-mask",function(){$(".js-share-box").hide(),$(".js-share-mask").hide()})});
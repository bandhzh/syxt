webpackJsonp([2],{285:function(t,e,i){var o=i(1)(i(361),i(394),null,null);t.exports=o.exports},316:function(t,e,i){"use strict";e.__esModule=!0;var o=i(15),s=(function(t){t&&t.__esModule}(o),"http://yx-web.nosdn.127.net/webdoc/h5/emoji"),n={emoji:{"[大笑]":{file:"emoji_0.png"},"[可爱]":{file:"emoji_01.png"},"[色]":{file:"emoji_02.png"},"[嘘]":{file:"emoji_03.png"},"[亲]":{file:"emoji_04.png"},"[呆]":{file:"emoji_05.png"},"[口水]":{file:"emoji_06.png"},"[汗]":{file:"emoji_145.png"},"[呲牙]":{file:"emoji_07.png"},"[鬼脸]":{file:"emoji_08.png"},"[害羞]":{file:"emoji_09.png"},"[偷笑]":{file:"emoji_10.png"},"[调皮]":{file:"emoji_11.png"},"[可怜]":{file:"emoji_12.png"},"[敲]":{file:"emoji_13.png"},"[惊讶]":{file:"emoji_14.png"},"[流感]":{file:"emoji_15.png"},"[委屈]":{file:"emoji_16.png"},"[流泪]":{file:"emoji_17.png"},"[嚎哭]":{file:"emoji_18.png"},"[惊恐]":{file:"emoji_19.png"},"[怒]":{file:"emoji_20.png"},"[酷]":{file:"emoji_21.png"},"[不说]":{file:"emoji_22.png"},"[鄙视]":{file:"emoji_23.png"},"[阿弥陀佛]":{file:"emoji_24.png"},"[奸笑]":{file:"emoji_25.png"},"[睡着]":{file:"emoji_26.png"},"[口罩]":{file:"emoji_27.png"},"[努力]":{file:"emoji_28.png"},"[抠鼻孔]":{file:"emoji_29.png"},"[疑问]":{file:"emoji_30.png"},"[怒骂]":{file:"emoji_31.png"},"[晕]":{file:"emoji_32.png"},"[呕吐]":{file:"emoji_33.png"},"[拜一拜]":{file:"emoji_160.png"},"[惊喜]":{file:"emoji_161.png"},"[流汗]":{file:"emoji_162.png"},"[卖萌]":{file:"emoji_163.png"},"[默契眨眼]":{file:"emoji_164.png"},"[烧香拜佛]":{file:"emoji_165.png"},"[晚安]":{file:"emoji_166.png"},"[强]":{file:"emoji_34.png"},"[弱]":{file:"emoji_35.png"},"[OK]":{file:"emoji_36.png"},"[拳头]":{file:"emoji_37.png"},"[胜利]":{file:"emoji_38.png"},"[鼓掌]":{file:"emoji_39.png"},"[握手]":{file:"emoji_200.png"},"[发怒]":{file:"emoji_40.png"},"[骷髅]":{file:"emoji_41.png"},"[便便]":{file:"emoji_42.png"},"[火]":{file:"emoji_43.png"},"[溜]":{file:"emoji_44.png"},"[爱心]":{file:"emoji_45.png"},"[心碎]":{file:"emoji_46.png"},"[钟情]":{file:"emoji_47.png"},"[唇]":{file:"emoji_48.png"},"[戒指]":{file:"emoji_49.png"},"[钻石]":{file:"emoji_50.png"},"[太阳]":{file:"emoji_51.png"},"[有时晴]":{file:"emoji_52.png"},"[多云]":{file:"emoji_53.png"},"[雷]":{file:"emoji_54.png"},"[雨]":{file:"emoji_55.png"},"[雪花]":{file:"emoji_56.png"},"[爱人]":{file:"emoji_57.png"},"[帽子]":{file:"emoji_58.png"},"[皇冠]":{file:"emoji_59.png"},"[篮球]":{file:"emoji_60.png"},"[足球]":{file:"emoji_61.png"},"[垒球]":{file:"emoji_62.png"},"[网球]":{file:"emoji_63.png"},"[台球]":{file:"emoji_64.png"},"[咖啡]":{file:"emoji_65.png"},"[啤酒]":{file:"emoji_66.png"},"[干杯]":{file:"emoji_67.png"},"[柠檬汁]":{file:"emoji_68.png"},"[餐具]":{file:"emoji_69.png"},"[汉堡]":{file:"emoji_70.png"},"[鸡腿]":{file:"emoji_71.png"},"[面条]":{file:"emoji_72.png"},"[冰淇淋]":{file:"emoji_73.png"},"[沙冰]":{file:"emoji_74.png"},"[生日蛋糕]":{file:"emoji_75.png"},"[蛋糕]":{file:"emoji_76.png"},"[糖果]":{file:"emoji_77.png"},"[葡萄]":{file:"emoji_78.png"},"[西瓜]":{file:"emoji_79.png"},"[光碟]":{file:"emoji_80.png"},"[手机]":{file:"emoji_81.png"},"[电话]":{file:"emoji_82.png"},"[电视]":{file:"emoji_83.png"},"[声音开启]":{file:"emoji_84.png"},"[声音关闭]":{file:"emoji_85.png"},"[铃铛]":{file:"emoji_86.png"},"[锁头]":{file:"emoji_87.png"},"[放大镜]":{file:"emoji_88.png"},"[灯泡]":{file:"emoji_89.png"},"[锤头]":{file:"emoji_90.png"},"[烟]":{file:"emoji_91.png"},"[炸弹]":{file:"emoji_92.png"},"[枪]":{file:"emoji_93.png"},"[刀]":{file:"emoji_94.png"},"[药]":{file:"emoji_95.png"},"[打针]":{file:"emoji_96.png"},"[钱袋]":{file:"emoji_97.png"},"[钞票]":{file:"emoji_98.png"},"[银行卡]":{file:"emoji_99.png"},"[手柄]":{file:"emoji_100.png"},"[麻将]":{file:"emoji_101.png"},"[调色板]":{file:"emoji_102.png"},"[电影]":{file:"emoji_103.png"},"[麦克风]":{file:"emoji_104.png"},"[耳机]":{file:"emoji_105.png"},"[音乐]":{file:"emoji_106.png"},"[吉他]":{file:"emoji_107.png"},"[火箭]":{file:"emoji_108.png"},"[飞机]":{file:"emoji_109.png"},"[火车]":{file:"emoji_110.png"},"[公交]":{file:"emoji_111.png"},"[轿车]":{file:"emoji_112.png"},"[出租车]":{file:"emoji_113.png"},"[警车]":{file:"emoji_114.png"},"[自行车]":{file:"emoji_115.png"}}};for(var a in n){var r=n[a];for(var c in r){var l=r[c];l.img=s+"/"+a+"/"+l.file}}for(var m={ajmd:{},xxy:{},lt:{}},f=1;f<=48;f++){var u="ajmd0"+(f>=10?f:"0"+f);m.ajmd[u]={file:u+".png"}}for(var p=1;p<=40;p++){var g="xxy0"+(p>=10?p:"0"+p);m.xxy[g]={file:g+".png"}}for(var d=1;d<=20;d++){var h="lt0"+(d>=10?d:"0"+d);m.lt[h]={file:h+".png"}}for(var _ in m){var j=m[_];for(var v in j){var y=j[v];y.img=s+"/"+_+"/"+y.file}}e.default={emojiList:n,pinupList:m},t.exports=e.default},317:function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var s=i(16),n=o(s),a=i(41),r=o(a),c=i(15),l=o(c),m=i(316),f=o(m);e.default={props:{type:String,rawMsg:{type:Object,default:function(){return{}}},userInfos:{type:Object,default:function(){return{}}},myInfo:{type:Object,default:function(){return{}}},isRobot:{type:Boolean,default:function(){return!1}},robotInfos:{type:Object,default:function(){return{}}}},data:function(){return{msg:"",isFullImgShow:!1,currentAudio:null}},computed:{robotInfos:function(){return this.$store.state.robotInfos}},beforeMount:function(){var t=(0,n.default)({},this.rawMsg);if("session"===this.type)if("in"===t.flow)if("robot"===t.type&&t.content&&t.content.msgOut){var e=t.content.robotAccid;t.avatar=this.robotInfos[e].avatar,t.isRobot=!0,t.link="#/namecard/"+e}else t.from!==this.$store.state.userUID?(t.avatar=this.userInfos[t.from]&&this.userInfos[t.from].avatar||l.default.defaultUserIcon,t.link="#/namecard/"+t.from):t.avatar=this.myInfo.avatar;else"out"===t.flow&&(t.avatar=this.myInfo.avatar);else t.showTime=r.default.formatDate(t.time);if("timeTag"===t.type)t.showText=t.text;else if("text"===t.type){if(t.showText=r.default.escape(t.text),/\[[^\]]+\]/.test(t.showText)){var i=t.showText.match(/\[[^\]]+\]/g);i.forEach(function(e){var i=f.default.emojiList.emoji;i[e]&&(t.showText=t.showText.replace(e,'<img class="emoji-small" src="'+i[e].img+'">'))})}}else if("custom"===t.type){var o=JSON.parse(t.content);if(1===o.type){var s=o.data,a=l.default.resourceUrl;t.type="custom-type1",t.imgUrl=a+"/im/play-"+s.value+".png"}else if(3===o.type){var c=o.data,m="";f.default.pinupList[c.catalog]&&(m=f.default.pinupList[c.catalog][c.chartlet],t.type="custom-type3",t.imgUrl=""+m.img)}else t.showText=r.default.parseCustomMsg(t),"[自定义消息]"!==t.showText&&(t.showText+=",请到手机或电脑客户端查看")}else if("image"===t.type)t.originLink=t.file.url;else if("video"===t.type);else if("audio"===t.type)t.audioSrc=t.file.mp3Url,t.showText=Math.round(t.file.dur/1e3)+'" 点击播放';else if("file"===t.type)t.fileLink=t.file.url,t.showText=t.file.name;else if("notification"===t.type)t.showText=r.default.generateChatroomSysMsg(t);else if("tip"===t.type)t.showText=t.tip;else if("robot"===t.type){var u=t.content||{},p=u.message||[];if(u.msgOut){if("bot"===u.flag)t.subType="bot",p=p.map(function(t){return"template"===t.type?t.content.json:"text"===t.type||"answer"===t.type?[{type:"text",text:t.content}]:"image"===t.type?[{type:"image",url:t.content}]:void 0}),t.message=p;else if("faq"===t.content.flag){t.subType="faq",t.query=p.query;var g=p.match.sort(function(t,e){return e.score-t.score});t.message=g[0]}}else t.robotFlow="out",t.showText=t.text}else t.showText="["+r.default.mapMsgType(t)+"],请到手机或电脑客户端查看";this.msg=t},mounted:function(){var t=this,e=this.msg;this.$nextTick(function(){var i=null;if("image"===e.type)i=new Image,i.src=e.file.url+"?imageView&thumbnail=180x0&quality=85";else if("custom-type1"===e.type)i=new Image,i.className="emoji-middle",i.src=e.imgUrl;else if("custom-type3"===e.type)i=new Image,i.className="emoji-big",i.src=e.imgUrl;else if("video"===e.type)if(/(mov|mp4|ogg|webm)/i.test(e.file.ext))i=document.createElement("video"),i.src=e.file.url,i.width=640,i.height=480,i.autoStart=!1,i.preload="metadata",i.controls="controls";else{var o=document.createElement("a");o.href=e.file.url,o.target="_blank",o.innerHTML='<i class="u-icon icon-file"></i>'+video.name,t.$refs.mediaMsg.appendChild(o)}i?(t.$refs.mediaMsg&&t.$refs.mediaMsg.appendChild(i),i.onload=function(){t.$emit("msg-loaded")},i.onerror=function(){t.$emit("msg-loaded")}):t.$emit("msg-loaded")})},methods:{revocateMsg:function(t){if(this.$store.state.currSessionId&&t&&t.data&&t.data.attrs){var e=t.data.attrs;if("robot"===e.type)return;if("out"===e.flow){var i=this;this.$vux.confirm.show({title:"确定需要撤回消息",onCancel:function(){},onConfirm:function(){i.$store.dispatch("revocateMsg",{idClient:e.idClient})}})}}},sendRobotBlockMsg:function(t,e){var i="[复杂按钮模板触发消息]";t.text&&1===t.text.length&&(i=t.text[0].text);var o=e.content.robotAccid;this.isRobot||(i="@"+this.robotInfos[o].nick+" "+i),this.$store.dispatch("sendRobotMsg",{type:"link",scene:e.scene,to:e.to,robotAccid:o,params:t.params,target:t.target,body:i})},continueRobotMsg:function(t){this.$store.dispatch("continueRobotMsg",t)},showFullImg:function(t){this.$store.dispatch("showFullscreenImg",{src:t})},playAudio:function(t){var e=this;this.currentAudio||(this.currentAudio=new Audio(t),this.currentAudio.play(),this.currentAudio.onended=function(){e.currentAudio=null})}}},t.exports=e.default},318:function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var s=i(41),n=(o(s),i(15)),a=(o(n),i(316)),r=(o(a),i(325)),c=o(r);e.default={components:{ChatItem:c.default},props:{type:String,canLoadMore:[String,Boolean],isRobot:{type:Boolean,default:function(){return!1}},msglist:{type:Array,default:function(){return[]}},userInfos:{type:Object,default:function(){return{}}},myInfo:{type:Object,default:function(){return{}}},robotInfos:{type:Object,default:function(){return{}}}},data:function(){return{isFullImgShow:!1,msgLoadedTimer:null}},methods:{showFullImg:function(t){this.$store.dispatch("showFullscreenImg",{src:t})},msgLoaded:function(){var t=this;clearTimeout(this.msgLoadedTimer),this.msgLoadedTimer=setTimeout(function(){t.$emit("msgs-loaded")},20)}}},t.exports=e.default},319:function(t,e,i){e=t.exports=i(4)(void 0),e.push([t.i,".p-chat-list .u-icon{width:1.4rem;height:1.6rem;margin-right:.2rem;vertical-align:bottom}",""])},320:function(t,e,i){e=t.exports=i(4)(void 0),e.push([t.i,".p-chat-history .u-msg .msg-link[data-v-236c641c]{display:none}",""])},321:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("ul",{staticClass:"m-chat-list p-chat-list",attrs:{id:"chat-list"}},[t.canLoadMore?i("li",{staticClass:"u-msg item-time"},[t._v("\n    ---- 上拉加载更多 ----\n  ")]):i("li",{staticClass:"u-msg item-time"},[t._v("\n    ---- 已无更多记录 ----\n  ")]),t._v(" "),t._l(t.msglist,function(e){return i("chat-item",{key:e.idClient,attrs:{type:t.type,rawMsg:e,isRobot:t.isRobot,userInfos:t.userInfos,robotInfos:t.robotInfos,myInfo:t.myInfo},on:{"msg-loaded":t.msgLoaded}})})],2)},staticRenderFns:[]}},322:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("li",{staticClass:"u-msg",class:{"item-me":"out"===t.msg.flow,"item-you":"in"===t.msg.flow,"item-time":"timeTag"===t.msg.type,"item-tip":"tip"===t.msg.type,"session-chat":"session"===t.type}},["timeTag"===t.msg.type?i("div",[t._v("---- "+t._s(t.msg.showText)+" ----")]):"tip"===t.msg.type?i("div",{staticClass:"tip"},[t._v(t._s(t.msg.showText))]):"in"===t.msg.flow||"out"===t.msg.flow?i("div",{directives:[{name:"touch",rawName:"v-touch:hold",value:t.revocateMsg,expression:"revocateMsg",arg:"hold"}],attrs:{idClient:t.msg.idClient,time:t.msg.time,flow:t.msg.flow,type:t.msg.type}},[t.msg.avatar?i("a",{staticClass:"msg-head",attrs:{href:t.msg.link}},[i("img",{attrs:{src:t.msg.avatar}})]):"notification"!==t.msg.type?i("p",{staticClass:"msg-user"},[i("em",[t._v(t._s(t.msg.showTime))]),t._v(t._s(t.msg.from))]):t._e(),t._v(" "),"text"===t.msg.type?i("span",{staticClass:"msg-text",domProps:{innerHTML:t._s(t.msg.showText)}}):"custom-type1"===t.msg.type?i("span",{ref:"mediaMsg",staticClass:"msg-text"}):"custom-type3"===t.msg.type?i("span",{ref:"mediaMsg",staticClass:"msg-text"}):"image"===t.msg.type?i("span",{ref:"mediaMsg",staticClass:"msg-text",on:{click:function(e){e.stopPropagation(),t.showFullImg(t.msg.originLink)}}}):"video"===t.msg.type?i("span",{ref:"mediaMsg",staticClass:"msg-text"}):"audio"===t.msg.type?i("span",{staticClass:"msg-text",on:{click:function(e){t.playAudio(t.msg.audioSrc)}}},[t._v(t._s(t.msg.showText))]):"file"===t.msg.type?i("span",{staticClass:"msg-text"},[i("a",{attrs:{href:t.msg.fileLink,target:"_blank"}},[i("i",{staticClass:"u-icon icon-file"}),t._v(t._s(t.msg.showText))])]):"robot"===t.msg.type?i("span",{staticClass:"msg-text",class:{"msg-robot":"out"!==t.msg.robotFlow&&!t.isRobot}},["out"===t.msg.robotFlow?i("div",[t._v(t._s(t.msg.showText))]):"bot"===t.msg.subType?i("div",t._l(t.msg.message,function(e){return i("div",t._l(e,function(e){return i("div",["text"===e.type?i("div",[i("p",[t._v(t._s(e.text))])]):"image"===e.type?i("div",[i("p",[i("img",{attrs:{src:e.url}})])]):"url"===e.type?i("div",[i("a",{class:e.style,attrs:{href:e.target,target:"_blank"}},[e.image?i("div",t._l(e.image,function(t){return i("p",[i("img",{attrs:{src:t.url}})])})):t._e(),t._v(" "),e.text?i("div",t._l(e.text,function(e){return i("p",[t._v(t._s(e.text))])})):t._e()])]):"block"===e.type?i("div",[i("a",{class:e.style,attrs:{params:e.params,target:e.target},on:{click:function(i){t.sendRobotBlockMsg(e,t.msg)}}},[e.image?i("div",t._l(e.image,function(t){return i("p",[i("img",{attrs:{src:t.url}})])})):t._e(),t._v(" "),e.text?i("div",t._l(e.text,function(e){return i("p",[t._v(t._s(e.text))])})):t._e()])]):t._e()])}))})):"faq"===t.msg.subType?i("div",[i("p",[t._v(t._s(t.msg.message.answer))])]):t._e(),t._v(" "),"out"===t.msg.robotFlow||t.isRobot?t._e():i("span",{staticClass:"msg-link"},[i("a",{staticClass:"link-right",on:{click:function(e){t.continueRobotMsg(t.msg.content.robotAccid)}}},[t._v("继续对话")])])]):"notification"===t.msg.type?i("span",{staticClass:"msg-text notify"},[t._v(t._s(t.msg.showText))]):i("span",{staticClass:"msg-text",domProps:{innerHTML:t._s(t.msg.showText)}}),t._v(" "),"fail"===t.msg.status?i("span",{staticClass:"msg-failed"},[i("i",{staticClass:"weui-icon-warn"})]):t._e()]):t._e()])},staticRenderFns:[]}},323:function(t,e,i){var o=i(319);"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);i(5)("6e57deea",o,!0)},324:function(t,e,i){var o=i(320);"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);i(5)("eecc2c64",o,!0)},325:function(t,e,i){i(324);var o=i(1)(i(317),i(322),"data-v-236c641c",null);t.exports=o.exports},326:function(t,e,i){i(323);var o=i(1)(i(318),i(321),null,null);t.exports=o.exports},328:function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var s=i(337),n=o(s),a=i(41),r=(o(a),i(15)),c=o(r);e.default={components:{ChatEmoji:n.default},updated:function(){var t=this;window.document.body.addEventListener("click",function(){t.isEmojiShown=!1})},props:{type:String,scene:String,to:String,isRobot:{type:Boolean,default:function(){return!1}}},watch:{continueRobotAccid:function(t,e){t&&this.robotInfos[t]&&(this.msgToSent="@"+this.robotInfos[t].nick+" "),this.$store.dispatch("continueRobotMsg","")},msgToSent:function(t,e){if("chatroom"!==this.type&&!this.isRobot){var i=this.msgToSent.indexOf("@");i>=0&&i===this.msgToSent.length-1?this.robotslist&&this.robotslist.length>0&&(this.isRobotListShown=!0):!0===this.isRobotListShown&&(this.isRobotListShown=!1)}}},data:function(){return{isEmojiShown:!1,isRobotListShown:!1,msgToSent:"",icon1:c.default.resourceUrl+"/im/chat-editor-1.png",icon2:c.default.resourceUrl+"/im/chat-editor-2.png",icon3:c.default.resourceUrl+"/im/chat-editor-3.png"}},computed:{continueRobotAccid:function(){return this.$store.state.continueRobotAccid},robotslist:function(){return this.$store.state.robotslist},robotInfos:function(){return this.$store.state.robotInfos},robotInfosByNick:function(){return this.$store.state.robotInfosByNick}},methods:{sendTextMsg:function(){if(/^\s*$/.test(this.msgToSent))return void this.$vux.alert.show({title:"请不要刷屏"});if(this.msgToSent.length>800)return void this.$vux.alert.show({title:"请不要超过800个字"});if(this.msgToSent=this.msgToSent.trim(),"session"===this.type)if(this.isRobot)this.$store.dispatch("sendRobotMsg",{type:"text",scene:this.scene,to:this.to,robotAccid:this.to,content:this.msgToSent,body:this.msgToSent});else{var t="",e="",i=this.msgToSent.match(/@[^\s@$]+/g);if(i)for(var o=0;o<i.length;o++){var s=i[o].replace("@","");if(this.robotInfosByNick[s]){t=this.robotInfosByNick[s].account,e=(this.msgToSent+"").replace(i[o],"").trim();break}}t?e?this.$store.dispatch("sendRobotMsg",{type:"text",scene:this.scene,to:this.to,robotAccid:t,content:e,body:this.msgToSent}):this.$store.dispatch("sendRobotMsg",{type:"welcome",scene:this.scene,to:this.to,robotAccid:t,body:this.msgToSent}):this.$store.dispatch("sendMsg",{type:"text",scene:this.scene,to:this.to,text:this.msgToSent})}else"chatroom"===this.type&&this.$store.dispatch("sendChatroomMsg",{type:"text",text:this.msgToSent});this.msgToSent=""},sendPlayMsg:function(){"session"===this.type?this.$store.dispatch("sendMsg",{type:"custom",scene:this.scene,to:this.to,pushContent:"[猜拳]",content:{type:1,data:{value:Math.ceil(3*Math.random())}}}):"chatroom"===this.type&&this.$store.dispatch("sendChatroomMsg",{type:"custom",pushContent:"[猜拳]",content:{type:1,data:{value:Math.ceil(3*Math.random())}}})},sendFileMsg:function(){var t=this.$refs.fileToSent;t.value&&("session"===this.type?this.$store.dispatch("sendFileMsg",{scene:this.scene,to:this.to,fileInput:t}):"chatroom"===this.type&&this.$store.dispatch("sendChatroomFileMsg",{fileInput:t}))},showEmoji:function(){this.isEmojiShown=!0},hideEmoji:function(){this.isEmojiShown=!1},addEmoji:function(t){this.msgToSent+=t,this.hideEmoji()},chooseRobot:function(t){if(t&&t.account){var e=this.msgToSent.length;0!==e&&"@"===this.msgToSent[e-1]||(this.msgToSent+="@"+t.nick+" "),this.msgToSent+=t.nick+" "}},hideRobotList:function(){this.isRobotListShown=!1}}},t.exports=e.default},329:function(t,e,i){"use strict";function o(t,e){var i={};for(var o in e){var s=e[o],n=[];for(var a in s)n.push({type:t,name:o,key:a,img:s[a].img});n.length>0&&(i[o]={type:t,name:o,list:n,album:n[0].img})}return i}e.__esModule=!0;var s=i(316),n=function(t){return t&&t.__esModule?t:{default:t}}(s);e.default={props:{type:String,scene:String,to:String},data:function(){return{currType:"emoji",currAlbum:"emoji"}},computed:{emoji:function(){return o("emoji",n.default.emojiList)},pinup:function(){return o("pinup",n.default.pinupList)},currEmoji:function(){return"emoji"===this.currType?this.emoji[this.currAlbum]:"pinup"===this.currType?this.pinup[this.currAlbum]:[]}},methods:{selectAlbum:function(t){this.currType=t.type,this.currAlbum=t.name},selectEmoji:function(t){"emoji"===this.currType?this.$emit("add-emoji",t.key):"pinup"===this.currType&&("session"===this.type?this.$store.dispatch("sendMsg",{type:"custom",scene:this.scene,to:this.to,pushContent:"[贴图表情]",content:{type:3,data:{catalog:this.currAlbum,chartlet:t.key}}}):"chatroom"===this.type&&this.$store.dispatch("sendChatroomMsg",{type:"custom",pushContent:"[贴图表情]",content:{type:3,data:{catalog:this.currAlbum,chartlet:t.key}}}),this.$emit("hide-emoji"))}}},t.exports=e.default},330:function(t,e,i){e=t.exports=i(4)(void 0),e.push([t.i,".robot.m-chat-editor-main .u-editor-input[data-v-23f73ce8]{padding-right:4.5rem}.robot.m-chat-editor-main .u-editor-icons[data-v-23f73ce8]{width:4rem}.m-chat-robot[data-v-23f73ce8]{overflow-y:scroll}.m-chat-robot .weui-cells .weui-cell__hd[data-v-23f73ce8]{margin-right:.5rem}",""])},331:function(t,e,i){e=t.exports=i(4)(void 0),e.push([t.i,".m-chat-emoji{position:absolute;top:-12rem;height:12rem;left:0;width:100%;border-top:1px solid #ccc;background-color:#fff}.m-chat-emoji .emoji-channel{position:relative;width:100%;height:auto;margin:0 1rem}.m-chat-emoji .emoji-channel .emoji-album{display:inline-block;padding:.1rem;width:1.8rem;height:1.8rem;border-right:1px solid #f0f0f0}.m-chat-emoji .emoji-channel .emoji-album img{margin:0;display:block;width:inherit;height:inherit}.m-chat-emoji .emoji-channel .emoji-album.active{background-color:#f0f0f0}.m-chat-emoji .emoji-content{position:relative;width:100%;height:10rem;background-color:#f0f0f0;overflow-y:auto}.m-chat-emoji .emoji-content .cnt{position:relative;display:block;margin:.4rem auto;text-align:left}.m-chat-emoji .emoji-content .emoji-item{display:inline-block;width:28px;height:28px;padding:2px;vertical-align:middle}.m-chat-emoji .emoji-content .emoji-item img{width:inherit;height:inherit}.m-chat-emoji .emoji-content .pinup-item{width:44px;height:44px}@media screen and (min-width:300px) and (max-width:420px){.m-chat-emoji .emoji-content .cnt{width:300px}}@media screen and (min-width:420px) and (max-width:600px){.m-chat-emoji .emoji-content .cnt{width:420px}}@media screen and (min-width:600px) and (max-width:720px){.m-chat-emoji .emoji-content .cnt{width:600px}}@media screen and (min-width:720px) and (max-width:1080px){.m-chat-emoji .emoji-content .cnt{width:720px}}@media screen and (min-width:1080px){.m-chat-emoji .emoji-content .cnt{width:1080px}}",""])},332:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"m-chat-editor",on:{click:t.hideRobotList}},[i("chat-emoji",{directives:[{name:"show",rawName:"v-show",value:t.isEmojiShown,expression:"isEmojiShown"}],attrs:{type:t.type,scene:t.scene,to:t.to},on:{"add-emoji":t.addEmoji,"hide-emoji":t.hideEmoji}}),t._v(" "),i("group",{directives:[{name:"show",rawName:"v-show",value:t.isRobotListShown,expression:"isRobotListShown"}],staticClass:"m-chat-emoji m-chat-robot"},t._l(t.robotslist,function(e){return i("cell",{key:e.account,attrs:{title:e.nick},nativeOn:{click:function(i){t.chooseRobot(e)}}},[i("img",{staticClass:"icon",attrs:{width:"20",src:e.avatar},slot:"icon"})])})),t._v(" "),i("div",{staticClass:"m-chat-editor-main",class:{robot:t.isRobot}},[i("span",{staticClass:"u-editor-input"},[i("textarea",{directives:[{name:"model",rawName:"v-model",value:t.msgToSent,expression:"msgToSent"}],domProps:{value:t.msgToSent},on:{input:function(e){e.target.composing||(t.msgToSent=e.target.value)}}})]),t._v(" "),i("span",{staticClass:"u-editor-icons"},[t.isRobot?t._e():i("span",{staticClass:"u-editor-icon",on:{click:function(e){e.stopPropagation(),t.showEmoji(e)}}},[i("i",{staticClass:"u-icon-img"},[i("img",{attrs:{src:t.icon1}})])]),t._v(" "),"session"!==t.type||t.isRobot?t._e():i("span",{staticClass:"u-editor-icon",on:{change:t.sendFileMsg}},[i("i",{staticClass:"u-icon-img"},[i("img",{attrs:{src:t.icon2}})]),t._v(" "),i("input",{ref:"fileToSent",attrs:{type:"file"}})]),t._v(" "),t.isRobot?t._e():i("span",{staticClass:"u-editor-icon",on:{click:function(e){e.stopPropagation(),t.sendPlayMsg(e)}}},[i("i",{staticClass:"u-icon-img"},[i("img",{attrs:{src:t.icon3}})])]),t._v(" "),i("span",{staticClass:"u-editor-send",on:{click:t.sendTextMsg}},[t._v("发 送")])])])],1)},staticRenderFns:[]}},333:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"m-chat-emoji"},[i("div",{staticClass:"emoji-content"},[i("div",{staticClass:"cnt"},t._l(t.currEmoji.list,function(e){return i("span",{staticClass:"emoji-item",class:{"pinup-item":"pinup"===e.type},on:{click:function(i){i.stopPropagation(),t.selectEmoji(e)}}},[i("img",{attrs:{src:e.img}})])}))]),t._v(" "),i("div",{staticClass:"emoji-channel"},[t._l(t.emoji,function(e){return i("span",{staticClass:"emoji-album",class:{active:e.name==t.currAlbum},on:{click:function(i){i.stopPropagation(),t.selectAlbum(e)}}},[i("img",{attrs:{src:e.album}})])}),t._l(t.pinup,function(e){return"session"===t.type?i("span",{staticClass:"emoji-album",class:{active:e.name==t.currAlbum},on:{click:function(i){i.stopPropagation(),t.selectAlbum(e)}}},[i("img",{attrs:{src:e.album}})]):t._e()})],2)])},staticRenderFns:[]}},334:function(t,e,i){var o=i(330);"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);i(5)("a9c393ea",o,!0)},335:function(t,e,i){var o=i(331);"string"==typeof o&&(o=[[t.i,o,""]]),o.locals&&(t.exports=o.locals);i(5)("50f145c4",o,!0)},336:function(t,e,i){i(334);var o=i(1)(i(328),i(332),"data-v-23f73ce8",null);t.exports=o.exports},337:function(t,e,i){i(335);var o=i(1)(i(329),i(333),null,null);t.exports=o.exports},361:function(t,e,i){"use strict";function o(t){return t&&t.__esModule?t:{default:t}}e.__esModule=!0;var s=i(336),n=o(s),a=i(326),r=o(a),c=i(41),l=o(c),m=i(62),f=o(m);e.default={components:{ChatEditor:n.default,ChatList:r.default},mounted:function(){var t=this;this.$store.dispatch("showLoading"),this.$store.dispatch("setCurrSession",this.sessionId),f.default.scrollChatListDown(),setTimeout(function(){t.$store.dispatch("hideLoading")},1e3)},updated:function(){f.default.scrollChatListDown()},destroyed:function(){this.$store.dispatch("resetCurrSession")},data:function(){return{leftBtnOptions:{backText:" ",preventGoBack:!0}}},computed:{sessionId:function(){return this.$route.params.sessionId},sessionName:function(){var t=this.sessionId,e=null;if(/^p2p-/.test(t)){if((e=t.replace(/^p2p-/,""))===this.$store.state.userUID)return"我的手机";if(this.isRobot)return this.robotInfos[e].nick;var i=this.userInfos[e]||{};return l.default.getFriendAlias(i)}if(/^team-/.test(t))return"群"},scene:function(){return l.default.parseSession(this.sessionId).scene},to:function(){return l.default.parseSession(this.sessionId).to},isRobot:function(){var t=this.sessionId,e=null;return!(!/^p2p-/.test(t)||(e=t.replace(/^p2p-/,""),!this.robotInfos[e]))},myInfo:function(){return this.$store.state.myInfo},userInfos:function(){return this.$store.state.userInfos},robotInfos:function(){return this.$store.state.robotInfos},msglist:function(){return this.$store.state.currSessionMsgs}},methods:{onClickBack:function(){window.history.go(-1)},msgsLoaded:function(){f.default.scrollChatListDown()},enterNameCard:function(){if(/^p2p-/.test(this.sessionId)){var t=this.sessionId.replace(/^p2p-/,"");if(t===this.$store.state.userUID)return void(location.href="#/general");location.href="#/namecard/"+t}}}},t.exports=e.default},394:function(t,e){t.exports={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"g-inherit m-article"},[i("x-header",{staticClass:"m-tab",attrs:{"left-options":t.leftBtnOptions},on:{"on-click-back":t.onClickBack}},[i("h1",{staticClass:"m-tab-top",on:{click:t.enterNameCard}},[t._v(t._s(t.sessionName))]),t._v(" "),i("a",{slot:"left"}),t._v(" "),i("group",{staticClass:"m-tab-right",slot:"right"},[i("a",{attrs:{href:"#/chathistory/"+t.sessionId}},[t._v("历史消息")])])],1),t._v(" "),i("div",{staticClass:"m-chat-main"},[i("chat-list",{attrs:{type:"session",msglist:t.msglist,userInfos:t.userInfos,robotInfos:t.robotInfos,myInfo:t.myInfo,isRobot:t.isRobot},on:{"msgs-loaded":t.msgsLoaded}}),t._v(" "),i("chat-editor",{attrs:{type:"session",scene:t.scene,to:t.to,isRobot:t.isRobot}})],1)],1)},staticRenderFns:[]}}});